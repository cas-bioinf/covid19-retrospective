# Data description for programmers/statisticians

This is a description of the measured values intended for people analyzing the data. Medical knowledge is not assumed, though the level of detail of the medical part would be shallow.

Currently this document describes the fake dataset generated by `fake_data_grein` which contain less markers and comorbidities than the actual data would. But the overall structure should stay the same. Also the document is based on consultations with clinicians, but was not checked by a clinician yet - all mistakes are my own.

## Basics

The data include only hospitalized patients.
We gather both _patient data_ which correspond to the state of the patient upon admission to hospital and some summary values and _disease progression data_ that are measured repeatedly over the course of the hospitalization. The dataset will be represented by a `list` that contains elements for each type of data.

The primary patient-centric measurement is the final outcome (discharged, deceased or continued hospitalization) and the breathing support the patient requires, this can be one of:

1. `AA` (Ambient air, no support required)
2. `Oxygen` (supplemental oxygen by a nasal tube or a light mask)
3. `NIPPV` (Non-invasive positive pressure ventilation)
4. `MV` (Mechanical, invasive ventilation)
5. `ECMO` (Extra corporeal membrane oxygenation - the patientâ€™s blood is oxygenated outside of their body).

Those are strictly ordered by severity.

## Patient data

Patient data is stored in the `patient_data` list element.

#### Basic quantities:

- `patient` a unique ID of the patient
- `site` a unique string identifying a study site. Study sites will be pseudonymized to increase patient anonymity, so the string will not be interpretable
- `age` age in years
- `sex` sex, `M` or `F`
- `bmi` the body mass index at hospital admission
- `outcome` final outcome of the patient, one of `Discharged`, `Hospitalized` (still hospitalized at the date of data collection), `Transferred` (when transferred to a different hospital) and `Death`. For most purposes `Transferred` can be considered as the same as `Hospitalized`
- `days_from_symptom_onset` number of days between symptom onset and hospitalization, "symptom onset" is defined as the day  the patient or their carer subjectively first noticed any symptoms associated with Covid-19. It might not be available and is not a very reliable marker, but is relevant to determine if the patient was treated very early in their disease or not.

#### Comorbidites:

- `myocardial_infarction` - number of myocardial infarction events ever experienced by the patient. Integer, 0 means never had a myocardial infraction
- `hypertension_drugs` - the number of different anti-hypertensive drugs the patient uses regularly as a rough measure of the severity of the hypertension condition. Integer 0 means either not diagnost or not treated for hypertension.
- `smoking` - does the patient smoke? Boolean.


#### Derived quantities 

Those are  quantities derived from disease progression data that might be useful in analysis:

- `worst_condition` the worst breathing level recorded or `Death` for deceased patients
- `first_day_invasive`, `last_day_invasive` the first and last days the patient was recorded as having invasive breathing support (`MV` or `ECMO`) - note that if the patient is removed from invasive ventilation and then deteriorates once more, this range will included some days without invasive ventilation.
- `days_hospitalized` total number of days hospitalized until death, discharge or data collection, ie. is right censored if `outcome` is `Hospitalized` or `Transferred`.
- `took_hcq` Took Hydroxychloroquine at least once? Boolean
- `took_az` Took Azithromycin at least once? Boolean
- `took_kaletra` Took Kaletra (Lopinavir/Ritonavir) at least once? Boolean
- `took_tocilizumab` Took Tocilizumab at least once? Boolean
- `first_day_antivirals` First day any of Hydroxychloroquine, Azithromycin or Kaletra was taken
- `first_day_tocilizumab` First day Tocilizumab was taken

## Disease progression data

The most important part of the disease progression data is the breathing data which contains the breathing support used for each day. Those data should not have any gaps and cover the whole hospitalization period.
Breathing data is stored in the `breathing_data` list element. The columns are:

- `patient` ID of the patient, matching `patient_data`
- `day` day of hospitalization (starting with 0 - first day at hospital)
- `breathing` an ordered factor representing the breathing level as described above

Note that `day` can in some rare cases be negative when some data is availabe before hospitalization (this would almost certainly be only PCR test results).

Finally we collect a bunch of clinical markers of which most important are the drugs the patient used. Those are available in both long and wide formats (as `marker_data` and `marker_data_wide`). Markers are not measured every day and can be systematically missing for a whole site. The frequency of measurement of different markers can differ.

In the long format, the columns are:

- `patient` ID of the patient
- `day` day of hospitalization (starting with 0)
- `marker` the name of the marker and/or drug taken
- `value` double value of the marker
- `censored` a character string indicating whether the marker observation was censored. One of `left`, `right` and `none`

In the wide format there is a column for each marker and for those, that can be censored an addtional `xx_censored` column.

The markers are:

- `pcr_positive` whether the patient had a PCR test for virus presence positive
- `pcr_value` if available, the Ct number of the PCR test, this is a rough indication of the viral load present. The higher Ct, the less virus was found. Ct number >35 is (mostly) considered a negative test. The concentration of viral RNA in the sample needs to increase roughly two-fold to make the Ct number drop by 1. 
- `oxygen_flow` when the patient is receiving supplemental oxygen  (the `Oxygen` breathing support), this records how much oxygen they receive in liters/minute. Unfortunately, this can't be interpreted too strongly  as a measure of severity, as the level of blood oxygenation achieved with the given flow must be considered (which is not yet included in the simulated dataset, will be added). 
- `crp` the C-reactive protein concentraion in blood in ng/ml. This is a non-specific marker of inflammation and lags the actual inflammation by 1-2 days. <3 is usually considered normal, > 30 indicates noticeable inflammation, viral pneumonias are associated with CRP around 50-100, bacterial pneumonia associated with CRP roughly 100-200 (bacterial superinfection is possible in Covid patients), CRP > 200 is associated with sepsis. The main advantage of CRP is that it changes by several order of magnitudes, much less than the measurement noise. Low levels can be censored but that's unlikely a major issue.
- `d_dimer` the concentration of the D-dimer in blood which indicates the amount of blood coagulation happening, which can be a mark of complications (thrombosis, inflammation). D-dimer levels react with quite quickly to changes in patient's state. The normal level changes with age from roughly 0.5 for young healthy persons to around 0.8 for older patients. Values > 1 are generally considered pathological.
- `ferritin` TODO, healthy patients have around 450. High levels can be censored.

For markers, missing values indicate the marker was not measured for the day.

The drugs are:

- Compounds with suspected activity against the virus itself:
  - `hcq` Hydroxychloroquine
  - `az` Azithromycin - usually administered in combination with HCQ
  - `kaletra` Kaletra (Lopinavir/Ritonavir)
- `tocilizumab` which is suspected to alleviate the immune reaction to the virus and shorten the severe phase of the disease

For drugs, the values indicate the dose. Missing values indicate the patient didn't take the drug the given day.

It probably doesn't make a lot of sense to distinguish different dosing regimes of the drugs (there won't be enough data). Also, the effect of the drugs should be longer than the days they were taken - this is especially true for HCQ which is only very slowly removed from the body and can stay quite long at therapeutic concentrations even after the patient stopped taking it. For this reason it probably makes sense to analyse only "days before taking the drug" and "days after taking the drug for the first time".
